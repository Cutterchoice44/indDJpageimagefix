<!-- File: /index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="google-cast-enabled" content="true">
  <title>Cutters Choice Radio</title>
  <link rel="canonical" href="https://cutterschoiceradio.com/">
  <meta name="description" content="Cutters Choice Radio — underground, community-driven electronic music: breakbeat, bass, rave and more. Listen live 24/7.">
  <meta name="robots" content="index, follow">
  <meta name="theme-color" content="#5A8785">

  <!-- Social preview -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Cutters Choice Radio">
  <meta property="og:description" content="Underground, community-driven electronic music: breakbeat, bass, rave and more. Listen live 24/7.">
  <meta property="og:url" content="https://cutterschoiceradio.com/">
  <meta property="og:site_name" content="Cutters Choice Radio">
  <meta property="og:image" content="https://cutterschoiceradio.com/images/logo.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Cutters Choice Radio">
  <meta name="twitter:description" content="Underground, community-driven electronic music: breakbeat, bass, rave and more. Listen live 24/7.">
  <meta name="twitter:image" content="https://cutterschoiceradio.com/images/logo.png">

  <!-- Perf hints -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="preconnect" href="https://app.radiocult.fm" crossorigin>
  <link rel="preconnect" href="https://cdn.socket.io" crossorigin>
  <link rel="preconnect" href="https://ccr-tv.cutterschoiceradio.com" crossorigin>
  <link rel="preconnect" href="https://www.mixcloud.com" crossorigin>
  <link rel="preconnect" href="https://widget.mixcloud.com" crossorigin>
  <link rel="preload" href="/images/logo.png" as="image" imagesrcset="/images/logo.png 1x">

  <!-- CSS -->
  <link rel="stylesheet" href="style.css?v=2025-12-15-5">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Cast + GA -->
  <script src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js" defer></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-3MSGZZ5QL6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-3MSGZZ5QL6');
  </script>

  <!-- Org JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Cutters Choice Radio",
    "url": "https://cutterschoiceradio.com",
    "logo": "https://cutterschoiceradio.com/images/logo.png",
    "sameAs": [
      "https://www.instagram.com/cutterschoiceradio",
      "https://www.facebook.com/cutterschoiceradio",
      "https://www.mixcloud.com/cutterschoiceradio",
      "https://tunein.com/radio/Cutters-Choice-Radio-s344746/"
    ]
  }
  </script>
</head>

<body>
  <!-- HEADER -->
  <header class="header-banner" role="banner">
    <div class="header-gif-right"></div>
    <div class="header-gif-left"></div>

    <div class="logo-container">
      <img class="logo" src="/images/logo.png" alt="Cutters Choice Radio Logo" loading="eager" decoding="async" width="160" height="160" fetchpriority="high">
    </div>

    <video class="header-wave header-wave-left" aria-hidden="true" muted loop autoplay playsinline preload="none">
      <source src="/images/audiowave.webm" type="video/webm">
    </video>

    <div class="title">
      <h1>Cutters Choice Radio</h1>
      <p class="tagline">The home of relentless flavas and significant bangers!</p>
    </div>

    <video class="header-wave header-wave-right" aria-hidden="true" muted loop autoplay playsinline preload="none">
      <source src="/images/audiowave.webm" type="video/webm">
    </video>

    <div class="logo-container">
      <img class="logo" src="/images/logo.png" alt="Cutters Choice Radio Logo" loading="eager" decoding="async" width="160" height="160">
    </div>
  </header>

  <div style="height:2px;background-color:var(--brand-teal);"></div>

  <!-- NAV -->
  <nav id="main-nav" aria-label="Primary">
    <div class="nav-menu">
      <a href="our-story.html"           class="nav-link">OUR STORY</a>
      <a href="index-ourDJS.html"        class="nav-link">OUR DJS</a>
      <a href="dj-selects.html"          class="nav-link">DJ SELECTS</a>
      <a href="best-of-2025-mixes.html"  class="nav-link">BEST OF 25 MIXES</a>
      <a href="cutty-ranks.html"         class="nav-link">CUTTY RANKS</a>
      <a href="schedule.html"            class="nav-link">SCHEDULE</a>
      <a href="merch.html"               class="nav-link">MERCH</a>

      <details class="nav-details" id="about-overlay">
        <summary class="nav-link" aria-label="About the station">ABOUT THE STATION</summary>
        <div class="about-panel" id="about-station-content">
          <p>Cutters Choice Radio is a community of resident DJs and selectors broadcasting across underground music of all genres, representing bass and rave culture. Explore each profile for bios, mixes and show times, and discover new artists on our weekly schedule.</p>
        </div>
      </details>
    </div>

    <div class="nav-actions">
      <a href="https://facebook.com/cutterschoiceradio"  target="_blank" rel="noopener noreferrer" class="social-icon" aria-label="Facebook">
        <i class="fab fa-facebook-f"></i>
      </a>
      <a href="https://instagram.com/cutterschoiceradio" target="_blank" rel="noopener noreferrer" class="social-icon" aria-label="Instagram">
        <i class="fab fa-instagram"></i>
      </a>
      <google-cast-button id="castBtn" title="Cast"></google-cast-button>
      <button id="manualCastBtn" class="nav-link" type="button" title="Cast this stream" aria-label="Cast this stream">CAST</button>
    </div>
  </nav>

  <div style="height:2px;background-color:var(--brand-teal);"></div>

  <!-- MAIN GRID -->
  <div class="grid-container">
    <!-- CHAT -->
    <section class="chat" aria-labelledby="chat-heading">
      <h2 id="chat-heading">Cutters Chat</h2>
      <iframe title="Cutters Choice Radio Chat"
              src="https://app.radiocult.fm/embed/chat/cutters-choice-radio?theme=midnight&primaryColor=%235A8785&corners=sharp"
              width="100%" height="700" frameborder="0"
              allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              loading="lazy" seamless></iframe>
      <div class="chat-actions"><button class="popout-btn" onclick="openChatPopup()">Pop Out Chat</button></div>
      <div class="rc-user-list-container"><div class="rc-user-list"></div></div>
    </section>

    <!-- LIVE -->
    <section class="live-player" aria-labelledby="now-dj">
      <h2 id="now-dj">Now Playing: Live</h2>

      <div class="player-container">
        <iframe id="inlinePlayer" title="Cutters Choice Radio player"
                src="https://app.radiocult.fm/embed/square-player/cutters-choice-radio?theme=midnight&primaryColor=%235A8785&corners=sharp"
                allow="autoplay; encrypted-media" loading="lazy"></iframe>

        <div id="now-archive" role="status" aria-live="polite">Loading archive show…</div>

        <button id="popOutBtn" class="popout-btn">Pop Out Player</button>
        <button id="chatPopupBtn" class="popout-btn chat-btn-mobile" onclick="openChatPopup()">Chat</button>

        <div class="tv-wrapper">
          <video
            id="ccrTv"
            playsinline
            muted
            autoplay
            controls
            preload="none"
            crossorigin="anonymous"
            poster="/images/archives-logo.jpeg"
          ></video>
        </div>
      </div>
    </section>

    <!-- SCHEDULE -->
    <section class="schedule" aria-labelledby="schedule-heading">
      <h2 class="schedule-heading" id="schedule-heading">This Week’s Lineup</h2>
      <div class="schedule-scroll" id="schedule-container">
        <p>Loading this week’s schedule…</p>
      </div>
    </section>

    <!-- MIXCLOUD -->
    <section class="mixcloud" aria-labelledby="mixcloud-heading">
      <h2 id="mixcloud-heading">Latest Archived Shows</h2>
      <div id="mixcloud-list"></div>
      <div class="add-mixcloud">
        <input id="mixcloud-url" type="text" placeholder="Paste Mixcloud URL here…">
        <button onclick="addMixcloud()">Add Show</button>
      </div>
    </section>
  </div>

  <!-- FOOTER -->
  <footer class="banner">
    <div class="footer-bar">
      <a class="policy-link" href="privacy-policy.html">PRIVACY POLICY</a>
      <span class="legal">Amazon, Alexa and all related logos are trademarks of Amazon.com, Inc. or its affiliates.</span>

      <!-- OneMusic (immediately after legal) -->
      <a class="logo-onemusic" href="https://onemusicnz.com" target="_blank" rel="noopener noreferrer" aria-label="OneMusic NZ">
        <img src="/images/ONEMUSICLOGO.png" alt="We’re licensed to play OneMusic NZ" loading="lazy" decoding="async">
      </a>

      <!-- Remaining logos -->
      <div class="footer-logos" role="group" aria-label="Listening platforms">
        <a href="http://www.internet-radio.com/?utm_source=cutterschoiceradio&utm_medium=banner&utm_campaign=partners-2025&utm_content=footer-static"
           title="Internet Radio" target="_blank"
           rel="noopener noreferrer nofollow sponsored"
           data-partner="internet-radio" data-placement="footer" aria-label="Internet Radio">
          <picture>
            <source srcset="/images/internet-radio.webp 1x, /images/internet-radio@2x.webp 2x" type="image/webp">
            <source srcset="/images/internet-radio.png 1x, /images/internet-radio@2x.png 2x" type="image/png">
            <img src="/images/internet-radio.png" alt="Internet Radio" loading="lazy" decoding="async"
                 referrerpolicy="no-referrer"
                 data-fallback="https://www.internet-radio.com/images/banners/Internet-Radio.com_Banner_Ad_Animated_Gif_728x90_v1.gif">
          </picture>
        </a>

        <a href="https://radioguide.fm/?utm_source=cutterschoiceradio&utm_medium=banner&utm_campaign=partners-2025&utm_content=footer-static"
           title="RadioGuide" target="_blank"
           rel="noopener noreferrer nofollow sponsored"
           data-partner="radioguide" data-placement="footer" aria-label="RadioGuide">
          <picture>
            <source srcset="/images/radioguide.webp 1x, /images/radioguide@2x.webp 2x" type="image/webp">
            <source srcset="/images/radioguide.png 1x, /images/radioguide@2x.png 2x" type="image/png">
            <img src="/images/radioguide.png" alt="RadioGuide" loading="lazy" decoding="async"
                 referrerpolicy="no-referrer"
                 data-fallback="https://radioguide.fm/public/img/banners/banner0.png">
          </picture>
        </a>

        <a href="https://onlineradiobox.com/" title="Online Radio Box" target="_blank"
           rel="noopener noreferrer nofollow sponsored"
           data-partner="onlineradiobox" data-placement="footer" aria-label="Online Radio Box">
          <img src="/images/online_radiobox.png" alt="Online Radio Box" loading="lazy" decoding="async">
        </a>

        <a href="https://www.amazon.com/Cutters-Choice-Radio/dp/B0FKHBCWS5"
           title="Alexa Skill – Cutters Choice Radio" target="_blank"
           rel="noopener noreferrer" data-partner="alexa" data-placement="footer"
           aria-label="Alexa Skill – Cutters Choice Radio">
          <img src="/images/alexa-logo.webp" alt="Alexa – Cutters Choice Radio skill" loading="lazy" decoding="async">
        </a>

        <a href="https://tunein.com/radio/Cutters-Choice-Radio-s344746/" target="_blank" rel="noopener noreferrer" aria-label="TuneIn">
          <img src="/images/tunein-logo.png" alt="TuneIn" loading="lazy" decoding="async">
        </a>

        <a href="https://radio.garden" target="_blank" rel="noopener noreferrer" aria-label="Radio Garden">
          <img src="/images/radio-garden.png" alt="Radio Garden" loading="lazy" decoding="async">
        </a>

        <!-- NEW: radio.net partner logo (placed far right) -->
        <a href="https://www.radio.net/s/cutterschoice"
           title="radio.net" target="_blank"
           rel="noopener noreferrer nofollow sponsored"
           data-partner="radio.net" data-placement="footer" aria-label="radio.net">
          <!-- why: file named radio.net.png per instruction; lazy to keep perf consistent -->
          <img src="/images/radio.net.png" alt="radio.net" loading="lazy" decoding="async">
        </a>
      </div>
    </div>
  </footer>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1" defer></script>
  <script src="script.js?v=2025-12-15-5" defer></script>
  <script src="slideshow.js?v=2025-12-15-5" defer></script>

  <!-- Move MERCH to row 2 on mobile -->
  <script>
    (function(){
      const mq = window.matchMedia('(max-width: 768px)');
      const navMenu    = document.querySelector('#main-nav .nav-menu');
      const navActions = document.querySelector('#main-nav .nav-actions');
      const merchLink  = document.querySelector('#main-nav .nav-menu a.nav-link[href$="merch.html"]');
      if (!navMenu || !navActions || !merchLink) return;

      const anchor = document.createElement('span');
      anchor.id = 'merch-return-anchor';
      anchor.style.display = 'none';
      merchLink.after(anchor);

      function moveIfNeeded(e){
        const isMobile = (e && 'matches' in e) ? e.matches : mq.matches;
        if (isMobile) {
          if (!merchLink.dataset.moved) {
            navActions.insertBefore(merchLink, navActions.firstChild);
            merchLink.dataset.moved = '1';
          }
        } else if (merchLink.dataset.moved) {
          anchor.before(merchLink);
          merchLink.dataset.moved = '';
        }
      }
      moveIfNeeded();
      (mq.addEventListener ? mq.addEventListener('change', moveIfNeeded) : mq.addListener(moveIfNeeded));
      window.addEventListener('orientationchange', moveIfNeeded);
    })();
  </script>

  <!-- JSON-LD events injector (kept) -->
  <script>
  (function(){
    const API_KEY = 'pk_0b8abc6f834b444f949f727e88a728e0';
    const STATION_ID = 'cutters-choice-radio';
    const DAYS_AHEAD = 7;
    const startISO = new Date().toISOString();
    const endISO   = new Date(Date.now() + DAYS_AHEAD * 24 * 60 * 60 * 1000).toISOString();
    const url = 'https://api.radiocult.fm/api/station/' + encodeURIComponent(STATION_ID) +
                '/schedule?startDate=' + encodeURIComponent(startISO) +
                '&endDate=' + encodeURIComponent(endISO) +
                '&expand=artist';
    fetch(url, { headers: { 'x-api-key': API_KEY } })
      .then(r => r.ok ? r.json() : Promise.reject(new Error('Schedule fetch failed: ' + r.status)))
      .then(data => {
        const events = Array.isArray(data?.schedules) ? data.schedules : Array.isArray(data) ? data : [];
        if (!events.length) return;

        const LISTEN_URL = 'https://cutterschoiceradio.com/listen';
        const ORG = { name: 'Cutters Choice Radio', url: 'https://cutterschoiceradio.com', logo: 'https://cutterschoiceradio.com/images/logo.png' };
        const items = events.map(ev => {
          const sISO = ev.startDateUtc || ev.startDate || ev.start;
          const eISO = ev.endDateUtc   || ev.endDate   || ev.end;
          const performers = (ev.artists || [])
            .map(a => a && a.name ? { '@type':'Person', name:a.name } : null)
            .filter(Boolean);
          const obj = {
            '@type': 'Event',
            name: ev.title || ev.name || 'Show',
            startDate: sISO, endDate: eISO,
            eventStatus: 'https://schema.org/EventScheduled',
            eventAttendanceMode: 'https://schema.org/OnlineEventAttendanceMode',
            location: { '@type': 'VirtualLocation', url: LISTEN_URL },
            organizer: { '@type': 'Organization', name: ORG.name, url: ORG.url, logo: ORG.logo }
          };
          if (performers.length) obj.performer = performers;
          return obj;
        });
        const script = document.createElement('script');
        script.type = 'application/ld+json';
        script.textContent = JSON.stringify({ '@context': 'https://schema.org', '@graph': items });
        document.head.appendChild(script);
      })
      .catch(err => console.warn('[CCR JSON-LD injector]', err));
  })();
  </script>

  <!-- GA4 outbound click + image fallback -->
  <script>
    (function () {
      document.addEventListener('click', function (e) {
        const a = e.target.closest && e.target.closest('a[href^="http"]');
        if (!a) return;
        const url = a.href;
        const host = (new URL(url)).hostname.replace(/^www\./, '');
        const partner = a.dataset.partner || host || 'external';
        const placement = a.dataset.placement || 'unknown';
        if (typeof gtag === 'function') {
          gtag('event', 'outbound_click', { event_category: 'engagement', event_label: url, link_url: url, partner, placement });
        }
      }, { capture: true });
    })();

    (function () {
      document.querySelectorAll('.footer-logos img[data-fallback]').forEach(function(img){
        img.addEventListener('error', function(){
          if (img.dataset.fallback && img.src !== img.dataset.fallback) {
            img.srcset = '';
            img.src = img.dataset.fallback;
          }
        }, { once: true });
      });
    })();
  </script>
</body>
</html>
